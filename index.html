<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Recorder  to with RecordRTC </title>
</head>

<body>
    <h1>Voice Recorder</h1>
    <button id="recordButton">Start Recording</button>
    <button id="stopButton" disabled>Stop Recording</button>
    <button id="downloadButton" disabled>Download Recording</button>
    <audio id="audioPlayer" controls></audio>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/RecordRTC/5.6.2/RecordRTC.min.js"></script>
    <script>
        let recorder;
        let audioBlob;

        const recordButton = document.getElementById('recordButton');
        const stopButton = document.getElementById('stopButton');
        const downloadButton = document.getElementById('downloadButton');
        const audioPlayer = document.getElementById('audioPlayer');

        recordButton.addEventListener('click', startRecording);
        stopButton.addEventListener('click', stopRecording);
        downloadButton.addEventListener('click', downloadRecording);

        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                recorder = RecordRTC(stream, {
                    type: 'audio',
                    mimeType: 'audio/wav',
                });
                recorder.startRecording();
                recordButton.disabled = true;
                stopButton.disabled = false;
            } catch (error) {
                console.error('Error accessing microphone:', error);
                alert('Error accessing microphone. Please ensure you have granted permission.');
            }
        }

        function stopRecording() {
            recorder.stopRecording(() => {
                audioBlob = recorder.getBlob();
                const audioUrl = URL.createObjectURL(audioBlob);
                audioPlayer.src = audioUrl;
                downloadButton.disabled = false;
                recordButton.disabled = false;
                stopButton.disabled = true;
            });
        }

        function downloadRecording() {
            const url = URL.createObjectURL(audioBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'recording.wav';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>

</html>